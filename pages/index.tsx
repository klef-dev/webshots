import type { NextPage } from "next";
import Head from "next/head";
import Image from "next/image";
import React, { Suspense } from "react";

const Home: NextPage = () => {
  const [url, setUrl] = React.useState<string>("");
  const [loading, setLoading] = React.useState<boolean>(false);
  const [webUrl, setWebUrl] = React.useState<string>("");
  const [screenShot, setScreenShot] = React.useState<string>("");

  React.useEffect(() => {
    if (typeof window !== "undefined") {
      setWebUrl(window.location.href);
    }
  }, []);

  const handleGetScreenshot = () => {
    setLoading(true);

    fetch("/api/screenshot?url=" + url)
      .then((res) => res.json())
      .then((data) => {
        setScreenShot(data?.image);
      })
      .finally(() => setLoading(false));
  };

  return (
    <div className="flex min-h-screen flex-col items-center justify-center py-2">
      <Head>
        <title>WebShots</title>
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className="flex w-full flex-1 flex-col items-center justify-center px-20 text-center">
        <h1 className="text-6xl font-bold">
          Welcome to <span className="text-blue-600">WebShots!!!</span>
        </h1>

        <p className="my-5 text-2xl">
          Get started by providing a link to the website you want to screenshot.
        </p>

        <div className="my-6 flex max-w-4xl  items-center justify-around sm:w-full">
          <input
            value={url}
            onChange={(event) => setUrl(event.target.value)}
            className="w-full p-10 outline-none border border-blue-600 rounded-l-2xl"
          />
          <button
            onClick={handleGetScreenshot}
            className="active:scale-105 transition-transform duration-200 ease-in w-fit p-10 outline-none border border-blue-600 text-white bg-blue-600 rounded-r-2xl"
          >
            {loading ? (
              <span className="flex items-center space-x-2">
                <svg
                  className={`animate-spin h-5 w-5 text-white bg-white`}
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                ></svg>{" "}
                <span>Capturing...</span>
              </span>
            ) : (
              <span>Capture!</span>
            )}
          </button>
        </div>
        {screenShot && (
          <div className="my-6 h-80 flex max-w-2xl relative  items-center justify-around sm:w-full">
            <Image
              className="object-contain"
              src={screenShot}
              alt={""}
              layout="fill"
            />
          </div>
        )}
        <div className="mt-6 flex max-w-4xl  items-center justify-around sm:w-full">
          <Suspense>
            <p className="text-lg">
              Or make a get request to this endpoint{" "}
              <code className="rounded-md bg-gray-100 p-3 font-mono text-lg">
                {webUrl}api/screenshot?url={url}
              </code>{" "}
            </p>
          </Suspense>
        </div>
      </main>

      <footer className="flex h-24 w-full items-center justify-center border-t">
        <a
          className="flex items-center justify-center gap-2"
          href="https://brimble.io"
          target="_blank"
          rel="noopener noreferrer"
        >
          Powered by{" "}
          <svg
            width="141"
            height="30"
            viewBox="0 0 141 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            className="text-primary w-28"
          >
            <path
              d="M32.6641 2.68115H35.2265V11.4591C36.0564 10.4747 37.1023 9.69504 38.2826 9.18071C39.4351 8.69045 40.6757 8.4408 41.9281 8.44706C43.1489 8.43582 44.3586 8.68003 45.4794 9.164C46.5552 9.62929 47.5298 10.3 48.3487 11.1386C49.6136 12.4674 50.4685 14.1328 50.8106 15.9352C51.1528 17.7376 50.9677 19.6005 50.2777 21.3004C49.3843 23.5008 47.6606 25.2611 45.4794 26.2005C44.3811 26.6799 43.1947 26.9241 41.9964 26.9174C40.7211 26.9224 39.4588 26.6612 38.2902 26.1503C37.1068 25.6287 36.0606 24.8394 35.2341 23.8446V26.5422H32.6641V2.68115ZM41.8172 10.9138C40.9359 10.9078 40.0632 11.0879 39.2563 11.4424C38.4735 11.7858 37.7655 12.2791 37.1723 12.8945C36.5734 13.5196 36.0932 14.2484 35.7551 15.0453C35.3997 15.8765 35.2197 16.7722 35.2265 17.6762C35.2148 19.4619 35.908 21.1801 37.1556 22.4578C37.7631 23.0757 38.4814 23.574 39.273 23.9266C40.0824 24.2834 40.9568 24.469 41.8413 24.4719C42.7258 24.4748 43.6014 24.2948 44.4131 23.9433C45.1893 23.6051 45.8916 23.1179 46.4804 22.5094C47.0703 21.89 47.5391 21.1657 47.8626 20.3738C48.2086 19.5406 48.3842 18.6466 48.379 17.7445C48.3855 15.9524 47.6998 14.2269 46.4652 12.9279C45.8701 12.3111 45.1635 11.8127 44.3827 11.4591C43.5771 11.0938 42.7018 10.9078 41.8172 10.9138Z"
              fill="currentColor"
            ></path>
            <path
              d="M61.2524 11.2541C60.3954 11.2432 59.5457 11.4124 58.7583 11.7508C58.0231 12.0695 57.3605 12.5346 56.811 13.1178C56.2568 13.7125 55.8221 14.4081 55.5305 15.1669C55.2223 15.9678 55.0678 16.8196 55.0748 17.6777V26.5908H52.5078V8.86326H55.0703V11.5624C56.6864 9.62729 58.5745 8.6582 61.2372 8.6582L61.2524 11.2541Z"
              fill="currentColor"
            ></path>
            <path
              d="M64.0861 2.54605C64.2923 2.54605 64.4966 2.58667 64.6871 2.6656C64.8777 2.74453 65.0508 2.86022 65.1967 3.00606C65.3425 3.1519 65.4582 3.32504 65.5371 3.5156C65.616 3.70615 65.6567 3.91038 65.6567 4.11663C65.6567 4.32289 65.616 4.52712 65.5371 4.71767C65.4582 4.90822 65.3425 5.08137 65.1967 5.22721C65.0508 5.37305 64.8777 5.48874 64.6871 5.56767C64.4966 5.6466 64.2923 5.68722 64.0861 5.68722C63.8802 5.69528 63.675 5.65996 63.4837 5.58355C63.2924 5.50714 63.1194 5.39134 62.9757 5.24369C62.7007 4.93268 62.5488 4.53183 62.5488 4.11663C62.5488 3.70144 62.7007 3.30058 62.9757 2.98958C63.1194 2.84192 63.2924 2.72613 63.4837 2.64972C63.675 2.57331 63.8802 2.53799 64.0861 2.54605ZM65.3908 8.82991V26.5909H62.8223V8.82991H65.3908Z"
              fill="currentColor"
            ></path>
            <path
              d="M94.7228 15.6605V26.5969H92.1953V16.0023C92.1953 14.4317 91.8312 13.2079 91.1031 12.331C90.3751 11.454 89.3624 11.0156 88.0653 11.0156C87.3671 11.0139 86.6758 11.1534 86.0329 11.4257C84.7574 11.9553 83.7314 12.9509 83.1636 14.2099C82.8783 14.8369 82.7326 15.5185 82.7368 16.2073V26.5908H80.2078V15.8656C80.2164 15.1951 80.1138 14.5278 79.904 13.8909C79.7168 13.3319 79.4205 12.8156 79.0321 12.372C78.6521 11.9483 78.186 11.6107 77.6651 11.3816C77.1107 11.1392 76.5112 11.017 75.9061 11.0232C75.2168 11.0197 74.5349 11.1653 73.9072 11.45C73.288 11.7301 72.7308 12.1308 72.2683 12.6287C71.7993 13.1362 71.4253 13.7237 71.164 14.3633C70.8883 15.035 70.7489 15.7547 70.7539 16.4807V26.5908H68.2188V8.82982H70.7463V10.9472C72.1133 9.30778 73.9011 8.48806 76.1097 8.48806C77.4068 8.48806 78.5207 8.77818 79.4513 9.35841C80.3819 9.93865 81.1789 10.8439 81.8421 12.0743C82.4791 10.9837 83.3768 10.0682 84.4547 9.41006C85.5156 8.78856 86.7265 8.46967 87.9559 8.48806C88.8878 8.47852 89.8119 8.65889 90.6718 9.01817C91.4782 9.35653 92.2031 9.86296 92.7983 10.5037C93.4058 11.1672 93.8811 11.9405 94.1988 12.7821C94.5515 13.7005 94.7293 14.6767 94.7228 15.6605Z"
              fill="currentColor"
            ></path>
            <path
              d="M97.1484 2.68115H99.7094V11.4591C100.54 10.4747 101.586 9.69498 102.767 9.18071C103.917 8.69411 105.154 8.44706 106.403 8.45465C107.625 8.44339 108.835 8.68759 109.956 9.17159C111.032 9.63688 112.007 10.3076 112.825 11.1462C114.09 12.475 114.945 14.1404 115.287 15.9428C115.63 17.7452 115.445 19.6081 114.754 21.3079C113.861 23.5084 112.137 25.2687 109.956 26.2081C108.857 26.6874 107.67 26.9317 106.472 26.925C105.197 26.9299 103.935 26.6686 102.767 26.1579C101.583 25.6365 100.536 24.8471 99.7094 23.8522V26.5498H97.1484V2.68115ZM106.302 10.9138C105.42 10.9078 104.547 11.0879 103.739 11.4424C102.957 11.7862 102.25 12.2795 101.657 12.8945C101.058 13.5196 100.578 14.2484 100.239 15.0453C99.8835 15.8764 99.7031 16.7721 99.7094 17.6762C99.6972 19.4622 100.391 21.1808 101.64 22.4578C102.248 23.0757 102.966 23.574 103.757 23.9266C104.567 24.2834 105.441 24.469 106.326 24.4719C107.21 24.4748 108.086 24.2948 108.897 23.9433C109.673 23.605 110.375 23.1179 110.963 22.5094C111.554 21.8901 112.023 21.1658 112.347 20.3738C112.691 19.5403 112.865 18.6463 112.859 17.7445C112.867 15.9524 112.182 14.2266 110.947 12.9279C110.351 12.3107 109.644 11.8123 108.863 11.4591C108.058 11.0942 107.185 10.9082 106.302 10.9138Z"
              fill="currentColor"
            ></path>
            <path
              d="M119.998 2.61426V26.5558H117.436V2.61426H119.998Z"
              fill="currentColor"
            ></path>
            <path
              d="M136.327 21.741L138.034 23.4483C137.255 24.5454 136.209 25.4266 134.996 26.0092C133.719 26.63 132.315 26.9456 130.895 26.9312C129.674 26.9381 128.465 26.694 127.342 26.2143C125.674 25.5071 124.251 24.3222 123.255 22.8086C122.258 21.2951 121.731 19.5205 121.74 17.7082C121.732 16.4745 121.982 15.2527 122.476 14.122C122.945 13.0338 123.615 12.0435 124.45 11.2026C125.288 10.3688 126.277 9.70271 127.365 9.24011C128.482 8.7594 129.686 8.51529 130.901 8.52317C132.185 8.5142 133.456 8.78074 134.629 9.3048C135.801 9.82885 136.847 10.5982 137.697 11.5611C138.535 12.5281 139.169 13.6551 139.559 14.8739C139.982 16.1844 140.137 17.5668 140.015 18.9386H124.506C124.617 19.7059 124.865 20.4469 125.239 21.1258C125.603 21.7961 126.089 22.3926 126.672 22.8848C127.254 23.3744 127.912 23.7664 128.62 24.0452C129.345 24.3322 130.118 24.4771 130.898 24.4721C131.992 24.4813 133.072 24.2298 134.048 23.7384C134.974 23.2894 135.761 22.5994 136.327 21.741ZM124.441 16.4809H137.39C137.262 15.7083 136.989 14.9668 136.587 14.2952C136.191 13.6393 135.693 13.051 135.112 12.5529C134.536 12.0545 133.878 11.6612 133.166 11.3909C132.44 11.1167 131.671 10.9782 130.895 10.9823C129.39 10.9813 127.935 11.5202 126.794 12.5013C125.598 13.537 124.771 14.9339 124.438 16.4809H124.441Z"
              fill="currentColor"
            ></path>
            <path
              d="M16.5758 11.5075H10.6868C10.5861 11.5075 10.4895 11.4675 10.4183 11.3963C10.3471 11.3251 10.3071 11.2285 10.3071 11.1278C10.3071 11.0271 10.3471 10.9305 10.4183 10.8593C10.4895 10.788 10.5861 10.748 10.6868 10.748H13.9267C15.352 10.748 16.7189 10.1818 17.7267 9.17403C18.7346 8.1662 19.3007 6.7993 19.3007 5.37402C19.3007 3.94874 18.7346 2.58184 17.7267 1.57401C16.7189 0.56619 15.352 0 13.9267 0H7.87829V5.06719C6.72285 5.60334 5.74469 6.4585 5.059 7.53197C4.37332 8.60543 4.00868 9.85249 4.00803 11.1263C4.0064 11.7199 4.08508 12.3111 4.24194 12.8837C2.58025 13.9212 1.3016 15.4716 0.599346 17.3003C-0.102903 19.1291 -0.190549 21.1369 0.349665 23.0199C0.889879 24.9029 2.02857 26.5588 3.59353 27.7372C5.15849 28.9155 7.06459 29.5523 9.02358 29.551H16.5758C18.9687 29.551 21.2636 28.6005 22.9556 26.9084C24.6477 25.2164 25.5983 22.9214 25.5983 20.5285C25.5983 18.1356 24.6477 15.8407 22.9556 14.1486C21.2636 12.4566 18.9687 11.506 16.5758 11.506V11.5075ZM16.5758 27.4564H9.02358C7.36058 27.4575 5.7528 26.8598 4.49434 25.7726C3.23588 24.6855 2.41087 23.1816 2.17024 21.5362C1.92961 19.8907 2.28945 18.2135 3.18392 16.8116C4.07839 15.4096 5.4477 14.3766 7.04136 13.9014C6.52554 13.2226 6.20957 12.4132 6.12906 11.5645C6.04855 10.7158 6.2067 9.86149 6.58569 9.09784C6.96467 8.33419 7.54942 7.69157 8.27403 7.24243C8.99864 6.79328 9.8343 6.55545 10.6868 6.55576H13.9267C14.2381 6.55576 14.5368 6.43205 14.757 6.21186C14.9772 5.99167 15.1009 5.69302 15.1009 5.38161C15.1009 5.07021 14.9772 4.77157 14.757 4.55137C14.5368 4.33118 14.2381 4.20747 13.9267 4.20747H9.97747V2.1007H13.9267C14.3626 2.09131 14.796 2.16905 15.2014 2.32937C15.6069 2.48969 15.9762 2.72936 16.2878 3.03432C16.5994 3.33927 16.847 3.70338 17.016 4.10528C17.185 4.50718 17.2721 4.93879 17.2721 5.37478C17.2721 5.81077 17.185 6.24238 17.016 6.64428C16.847 7.04618 16.5994 7.41029 16.2878 7.71524C15.9762 8.0202 15.6069 8.25987 15.2014 8.42019C14.796 8.58051 14.3626 8.65825 13.9267 8.64886H10.6868C10.3562 8.64067 10.0273 8.69872 9.7195 8.81958C9.41168 8.94044 9.13115 9.12167 8.89443 9.3526C8.65772 9.58353 8.4696 9.85948 8.34116 10.1642C8.21272 10.469 8.14655 10.7963 8.14655 11.127C8.14655 11.4577 8.21272 11.7851 8.34116 12.0898C8.4696 12.3945 8.65772 12.6705 8.89443 12.9014C9.13115 13.1324 9.41168 13.3136 9.7195 13.4345C10.0273 13.5553 10.3562 13.6134 10.6868 13.6052H16.5758C18.394 13.6321 20.1286 14.3733 21.4049 15.6686C22.6811 16.9639 23.3966 18.7093 23.3966 20.5278C23.3966 22.3462 22.6811 24.0916 21.4049 25.3869C20.1286 26.6822 18.394 27.4234 16.5758 27.4503V27.4564ZM16.5758 15.7119H9.02358C8.38316 15.7006 7.74689 15.8169 7.15191 16.0541C6.55694 16.2913 6.01518 16.6447 5.55826 17.0936C5.10134 17.5425 4.73842 18.0779 4.49068 18.6685C4.24294 19.2592 4.11535 19.8933 4.11535 20.5338C4.11535 21.1743 4.24294 21.8085 4.49068 22.3991C4.73842 22.9898 5.10134 23.5252 5.55826 23.9741C6.01518 24.423 6.55694 24.7763 7.15191 25.0135C7.74689 25.2508 8.38316 25.3671 9.02358 25.3557H16.5758C17.2162 25.3671 17.8524 25.2508 18.4474 25.0135C19.0424 24.7763 19.5842 24.423 20.0411 23.9741C20.498 23.5252 20.8609 22.9898 21.1087 22.3991C21.3564 21.8085 21.484 21.1743 21.484 20.5338C21.484 19.8933 21.3564 19.2592 21.1087 18.6685C20.8609 18.0779 20.498 17.5425 20.0411 17.0936C19.5842 16.6447 19.0424 16.2913 18.4474 16.0541C17.8524 15.8169 17.2162 15.7006 16.5758 15.7119ZM16.5758 23.2565H9.02358C8.30167 23.2565 7.60933 22.9698 7.09887 22.4593C6.58841 21.9488 6.30163 21.2565 6.30163 20.5346C6.30163 19.8127 6.58841 19.1203 7.09887 18.6099C7.60933 18.0994 8.30167 17.8126 9.02358 17.8126H16.5758C17.2977 17.8126 17.99 18.0994 18.5005 18.6099C19.0109 19.1203 19.2977 19.8127 19.2977 20.5346C19.2977 21.2565 19.0109 21.9488 18.5005 22.4593C17.99 22.9698 17.2977 23.2565 16.5758 23.2565Z"
              fill="currentColor"
            ></path>
          </svg>
        </a>
      </footer>
    </div>
  );
};

export default Home;
